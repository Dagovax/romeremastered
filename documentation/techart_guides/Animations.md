![Workshop_header_template](/Workshop_header_template.png)
# Animations

| Concept | Details |
|-|-|
| **Tools**| **[Vercingetorix's xidx packer](https://github.com/AKAfreaky/XIDX)** (Windows/MacOS/Linux)</br></br> Used to extract/pack the animation pack data. </br></br> <ol><li>Place the `xidx.exe`, `extract_animations.bat` and `pack_animations.bat` in `Data\data\animations`. <li> Run the `extract_animations.bat` to unpack the `pack.dat` file and generate the ‘data’ folder containing the .cas file animations. <li> After making edits to the `.cas` files run the `pack_animations.bat` file to repack the animations as a new `pack.dat` file. </ol> </br></br> **[CAS Exporter](/tools/CasPacker/casconv.md)** </br></br> Allows import/export of animation `.cas` files for use in 3D software. </br></br> <ol><li> **Obtain Model from data** </br><br> `.\casconv -i ..\pathtodata\models\roman_peasant.cas -o roman_peasant.fbx -f fbx` </br></br> <li> **Apply a pack animation** </br></br> `.\casconv -i roman_peasant.cas -o roman_peasant_run.fbx -f fbx --animation LID_04 Run Loop.cas` </br></br>*- import to 3D software* </br></br> <li> **Export animation as .cas** </br></br> `.\casconv -i roman_peasant-run.fbx --export-animation-only -o lidrun.cas -f cas` </br></br> *- Run* `pack_animation.bat` </ol> </br></br> **[Skelconverter.py](/tools/SkeletonConverter/SkeletonConverter.md)**</br> After packing the animations with the ‘idx extractor/packer made by Vercingetorix’ you will need to use the `skelconverter.py` to convert the `skeletons.dat` and skeletons idx to a compatible format for Total War: Rome Remastered. `skelconverter.py` can be run in the command line or IDLE editor. The script requires Python to run. </br></br> <ol><li>Once `skelconverter.py` is started you will be asked for the path to the file you want to convert (this is relative to the location of the python script, best to place in the same directory as `skeleton.dat`).<li>The `skeleton.dat` or `skeleton.idx` can be provided, the other file will automatically be picked up.<li>The animations will be converted and a ‘`skeletons_new.dat`’ and ‘`skeletons_new.idx`’ will be generated.<li>These files can then be renamed to ‘`skeletons.dat`’ and ‘`skeletons.idx`’ and placed in the relevant folder. </ol> |
|**File Path Information**| The original packed animation files can be found in `Data\data\animations`. </br></br> Ferals additional animations can be found in `Data\data\animations\extra`.|
|**Skeleton Details**| For Human units there are 2 different types of skeleton structures. <br/> <br/> <ul> <li> **Normal skeleton** </li> <li> **Slinger skeleton** *(in `descr.txt` files this is reference to as **“`fs_slinger_new`”**)* </li></ul> Both skeletons are pretty much the same, however the slinger has an extra bone parented under the **“rbone_hand”**. </br></br> The bone hierarchy __must not change!__  The game expects the bones to be listed in a specific order. <span style="color:red"> ***Slinger ONLY*!** </span> </br></br> There should be NO translation keyframes on any bone except for bone_pelvis. </br></br> For Animal units there are 4 different types of skeleton structures: </br><ul><li> Wardog skeleton <li> Elephant skeleton <li> Horse skeleton <li> Pig skeleton </ul> </br> Again there should be **NO** translation keyframes on any bone except for **bone_pelvis**. </br><br/> ______________________________________________________________ <br/> **Bone Hierarchy Example for human units** </br></br> ![Bone Hierarchy Image](/documentation/techart_guides/images/Bone_Hierarchy.png)|
|**Rules**| There are a number of rules that **MUST** be adhered to in order for animations to export and appear correctly in game: </br></br> <ul> <li>The first keyframe of an animation must be on frame 1. <li>The final keyframe of an animation must be on an odd number of frames meaning the animation length is a multiple of 1/10th of a second. <li>The **Scene_Root** bone should never have any keyframes across any skeletons. <li>Across all bones (excluding **bone_Pelvis**) the only values that should contain animation should be the XYZ rotation values <li>**Note** that all animations should run at 20 fps. </ul> |
|**Text Files**| Animation linkages for the original animation files can be found in `descr_skeleton.txt`. </br></br> Animation linkages for files found in the `Data\data\animations\extra` folder can be found in the `descr_skeleton_feral_overrides.txt`|
